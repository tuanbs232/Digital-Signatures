package com.bkav.bkavsignature.test;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;

import com.bkav.bkavsignature.cms.CMSSigner;
import com.bkav.bkavsignature.cms.CMSValidator;
import com.bkav.bkavsignature.utils.BkavSignaturesException;
import com.bkav.bkavsignature.utils.CryptoToken;
import com.bkav.bkavsignature.utils.CryptoTokenUtil;
import com.bkav.bkavsignature.utils.FileUtil;
import com.itextpdf.text.pdf.codec.Base64;

public class CMSSignerTestClass {
	public static void main(String[] args) {
		signTest();
	}

	public static void verifyTest() {
		// String inputPath =
		// "S:/WORK/2016/05-2016/Test_Files/Signeds/signed.p7b";

		// No content detached = false
		// String inputPath = "S:/WORK/2016/03-2016/Test
		// Files/signed_no_content.p7s";
		// --> Need data content to verify;
		// Using: CMSSignedData signedData = new CMSSignedData(signedContent,
		// signedData);

		// byte[] signedData = null;
		// try {
		// signedData = FileUtil.readBytesFromFile(inputPath);
		// } catch (IOException e1) {
		// e1.printStackTrace();
		// }

		String input = "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";
		byte[] signedData = Base64.decode(input);
		// FileUtil.writeToFile(signedData,
		// "S:/WORK/2016/05-2016/Test_Files/Signeds/text_signed.p7s");

		if (signedData == null) {
			System.out.println("data null");
			return;
		}
		CMSValidator validator = new CMSValidator();
		System.out.println(validator.verify(signedData));
	}

	public static void signTest() {
		String data = "Data to test";
		final String TEST_KEYSTORE_PATH = "S:/WORK/2016/03-2016/PKCS12_TOKEN/BCSE_Client.p12";
		final String TEST_KEYSTORE_PASS = "12345678";

		byte[] dataToSign = data.getBytes();

		CMSSigner signer = new CMSSigner();
		try {
			FileInputStream inStream = new FileInputStream(
					new File(TEST_KEYSTORE_PATH));
			CryptoToken token = CryptoTokenUtil.initFromPkcs12(inStream,
					TEST_KEYSTORE_PASS);
			byte[] signedBytes = signer.sign(dataToSign, token, true);

			FileUtil.writeToFile(signedBytes,
					"S:/WORK/2016/05-2016/Test_files/Signeds/signed.p7b");
			System.out.println("Complete. Signed data store at: "
					+ "S:/WORK/2016/05-2016/Test_files/Signeds/signed.p7b");
		} catch (BkavSignaturesException e) {
			e.printStackTrace();
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public static void signTestUsingPkcs11() {
		String configDir = "S:/WORK/2016/06-2016/E-Token/config.cfg";
		String pin = "12345678";
		String data = "Data to test";

		CryptoToken token = null;
		try {
			token = CryptoTokenUtil.initFromPkcs11(configDir, pin);
			if (token == null) {
				System.out.println("Token null");
				return;
			}

			byte[] dataToSign = data.getBytes();

			CMSSigner signer = new CMSSigner();
			byte[] signedBytes = signer.sign(dataToSign, token, true);

			FileUtil.writeToFile(signedBytes,
					"S:/WORK/2016/05-2016/Test_files/Signeds/signed.p7b");
			System.out.println("Complete. Signed data store at: "
					+ "S:/WORK/2016/05-2016/Test_files/Signeds/signed.p7b");
		} catch (BkavSignaturesException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}
